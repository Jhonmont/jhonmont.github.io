<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Evaluación de Modelos de Regresion Lineal</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
  <link rel="stylesheet" href="python_css/python_posts.css" />
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe"> </script>
  <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: { 
                    automatic: true 
                    }
                },
                "HTML-CSS": {
                    linebreaks: { 
                    automatic: true 
                    }
                }
            });
        
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
  <!-- ************************ Common Code ************************ -->
  <link href="../../assets/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>
  <link href="../assets/css/headers.css" rel="stylesheet">
  <!-- ************************ Common Code ************************ -->
</head>

<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
  <!-- ************************ Common Code ************************ -->
  <div class="container">
    <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
      <a href="../../index.html"
        class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
        <svg class="bi me-2" width="40" height="32">
          <use xlink:href="#bootstrap" />
        </svg>
        <span style="color: var(--jp-content-link-color);">Volver al Inicio</span>
      </a>
      <ul class=" nav nav-pills">
        <li class="nav-item"><a href="eda_con_tecnicas_de_visualizacion.html" class="nav-link">Anterior</a></li>
        <li class="nav-item"><a href="introduccion_aprendizaje_automatico.html" class="nav-link">Siguiente</a></li>
      </ul>
    </header>
  </div>
  <div style="padding-left: 50px; padding-right: 100px;">
    <!-- ************************ Common Code ************************ -->
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h2>
          Evaluación de Modelos de Regresión Lineal
        </h2>
        <p style="font-size: medium;">
          <strong>
               Publicado el: 15 de Febrero del 2021
          </strong> - Jhonatan Montilla</p>
        <p>
        <p>En el siguiente caso de uso, se desea predecir el precio de una vivienda mediante el uso de funciones
          independientes o variables como promedio de renta de las personas, población de la zona y edad de la vivienda.
          Se determinará si las variables independientes fluctúan, para determinar si el precio de la vivienda también
          fluctúa. Por tanto, el objetivo principal es trazar la línea que mejor se ajuste a estas características (una
          línea recta). En la ciencia de datos, la mayoría de las cosas dependen de los datos, qué tipo de datos se
          utilizan, entonces para la regresión lineal se deben asumir algunas consideraciones sobre nuestros datos.</p>
        <ul>
          <li>
            <p>Se asume que la relación entre las variables dependientes e independientes es lineal, esto es un caso muy
              estraño en los datos del mundo real.</p>
          </li>
          <li>
            <p>Los datos deben ser independientes.</p>
          </li>
          <li>
            <p>En el modelo se asume que no hay multicolinealidad en los datos.</p>
          </li>
        </ul>
        <h3>
          La matemática detrás de un algoritmo de Regresión Lineal.
        </h3>
        <p>y = mx + c (aquí la ecuación de la recta)</p>
        <p><strong>Y:</strong> Es lo que queremos predecir o variable dependiente,
          <strong>X:</strong> Value (variable independiente) nos ayudará a predecir el valor de Y,
          <strong>m:</strong> Es la pendiente de la línea y,
          <strong>C:</strong> Es la intersección del eje Y.
        </p>
        <h2">
          Tipos de regresión lineal.
          </h2>
          <ul>
            <li>
              <p><strong>Regresión lineal simple:</strong> Predice la salida usando una sola característica.</p>
            </li>
            <li>
              <p><strong>Regresión lineal múltiple:</strong> Predice la salida utilizando múltiples funciones.</p>
            </li>
          </ul>
          <h2>
            Usos de la regresión lineal.
          </h2>
          <h3>
            Análisis predictivo.
          </h3>
          <p>El análisis predictivo pronostica oportunidades y riesgos futuros es la aplicación más destacada del
            análisis de regresión en los negocios. El análisis de la demanda, por ejemplo, predice la cantidad de
            artículos que probablemente comprará un consumidor.</p>
          <h3>Eficiencia operativa.</h3>
          <p>Los Modelos de Regresión Lineal también se pueden utilizar para optimizar los procesos de negocio. En un
            call center se puede analizar la relación entre los tiempos de espera de las personas que llaman y el número
            de quejas. La toma de decisiones basada en datos elimina las conjeturas, las hipótesis y las políticas
            corporativas en la toma de decisiones.</p>
          <h3>
            Decisiones de apoyo.
          </h3>
          <p>La regresión lineal no solo es excelente para brindar apoyo empírico a las decisiones de gestión, sino
            también para identificar errores de juicio. Un empleado en una gerencia puede pensar que al extender las
            compras aumentará las ventas, sin embargo, un modelo de regresión lineal podría indicar que el aumento de
            los ingresos puede no ser suficiente para respaldar el aumento de los cargos laborales adicionales de los
            empleados para la Empresa.</p>
          <h3>
            Nuevas perspectivas.
          </h3>
          <p>Como los datos son inútiles sin un análisis adecuado, es necesario aplicar técnicas de análisis de
            regresión con el objetivo de encontrar la relación entre diferentes variables al descubrir patrones que
            antes pasaban desapercibidos.</p>
          <h3>
            Caso de estudio.
          </h3>
          <p>Se comienza con la carga de los módulos de python necesarios y el conjunto de datos el cual podrá descargar
            directamente desde nuestro repositorio haciendo
       <!-- ************************ Common Code ************************ -->
            <a href="https://github.com/Jhonmont/all_datasets_repository" target="_blank">
                 clic aquí.
            </a>
       </p>
       <!-- ************************ Common Code ************************ -->
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;ecommerce_customers.csv&quot;</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Descripción de Variables
        </h3>
        <ul>
          <li><strong>Email:</strong> Correo electrónico del cliente</li>
          <li><strong>Address:</strong> Dirección de habitación del cliente</li>
          <li><strong>Avg. Session Lenght:</strong> Tiempo promedio en que el cliente permanece conectado (en minutos)
          </li>
          <li><strong>Time on App:</strong> Tiempo total en que el cliente se conecta através de la aplicación (en
            minutos)</li>
          <li><strong>Time on Website:</strong> tiempo total en que el cliente se conecta a través del portal web (en
            minutos)</li>
          <li><strong>Length of Membership:</strong> Tiempo de la menbresía del cliente (en meses)</li>
          <li><strong>Yearly Amount Spent:</strong> Cantidad de dinero que ha gastado en cliente anualmente con el
            servicio de la Empresa (en USD).</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>Email</th>
                      <th>Address</th>
                      <th>Avatar</th>
                      <th>Avg. Session Length</th>
                      <th>Time on App</th>
                      <th>Time on Website</th>
                      <th>Length of Membership</th>
                      <th>Yearly Amount Spent</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>mstephenson@fernandez.com</td>
                      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
                      <td>Violet</td>
                      <td>34.50</td>
                      <td>12.66</td>
                      <td>39.58</td>
                      <td>4.08</td>
                      <td>587.95</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>hduke@hotmail.com</td>
                      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
                      <td>DarkGreen</td>
                      <td>31.93</td>
                      <td>11.11</td>
                      <td>37.27</td>
                      <td>2.66</td>
                      <td>392.20</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>pallen@yahoo.com</td>
                      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
                      <td>Bisque</td>
                      <td>33.00</td>
                      <td>11.33</td>
                      <td>37.11</td>
                      <td>4.10</td>
                      <td>487.55</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>riverarebecca@gmail.com</td>
                      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
                      <td>SaddleBrown</td>
                      <td>34.31</td>
                      <td>13.72</td>
                      <td>36.72</td>
                      <td>3.12</td>
                      <td>581.85</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>mstephens@davidson-herman.com</td>
                      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
                      <td>MediumAquaMarine</td>
                      <td>33.33</td>
                      <td>12.80</td>
                      <td>37.54</td>
                      <td>4.45</td>
                      <td>599.41</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Cantidad de Clientes registrados.
        </h3>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Avatar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
            <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
              <pre>&lt;bound method Series.unique of 0                Violet
1             DarkGreen
2                Bisque
3           SaddleBrown
4      MediumAquaMarine
             ...       
495                 Tan
496       PaleVioletRed
497            Cornsilk
498                Teal
499         DarkMagenta
Name: Avatar, Length: 500, dtype: object&gt;</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Revisión de tipos de variables en el conjunto de datos.
        </h3>
        <ul>
          <li>4 variables de tipo objeto</li>
          <li>5 variables de tipo numérico decimal</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 500 entries, 0 to 499
Data columns (total 8 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   Email                 500 non-null    object 
 1   Address               500 non-null    object 
 2   Avatar                500 non-null    object 
 3   Avg. Session Length   500 non-null    float64
 4   Time on App           500 non-null    float64
 5   Time on Website       500 non-null    float64
 6   Length of Membership  500 non-null    float64
 7   Yearly Amount Spent   500 non-null    float64
dtypes: float64(5), object(3)
memory usage: 25.5+ KB
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Revisión de datos estadísticos
        </h3>
        <p>En esta sección se revisan algunos datos estadísticos contenidos en el conjunto de datos.</p>
        <p><strong>Respecto a la cantidad de dinero invertida por el cliente</strong></p>
        <ul>
          <li>La máxima cantidad de dinero gastado por un cliente en el servicio de la empresa es de: 765.52 USD</li>
          <li>En promedio los clientes gastan en el sevicio de la empresa: 499.31 USD</li>
        </ul>
        <p><strong>Respecto a la antiguedad de los clientes</strong></p>
        <ul>
          <li>El cliente más antiguo de la Empresa tiene una membresía de: 6.92 meses</li>
        </ul>
        <p><strong>Respecto al tiempo de conexión de los clientes en la Aplicación</strong></p>
        <ul>
          <li>El mayor lapso de tiempo que un cliente permanece conectado a través de la aplicación es de: 15.13 minutos
          </li>
          <li>El lapso de tiempo promedio que un cliente permanece conectado a través de la aplicación es de: 12.05
            minutos</li>
        </ul>
        <p><strong>Respecto al tiempo de conexión de los clientes a través del portal web</strong></p>
        <ul>
          <li>El mayor lapso de tiempo que un cliente permanece conectado a través del portal web es de: 40.01 minutos
          </li>
          <li>El lapso de tiempo promedio que un cliente permanece conectado a través del portal web es de: 37.06
            minutos</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>Avg. Session Length</th>
                      <th>Time on App</th>
                      <th>Time on Website</th>
                      <th>Length of Membership</th>
                      <th>Yearly Amount Spent</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>count</th>
                      <td>500.00</td>
                      <td>500.00</td>
                      <td>500.00</td>
                      <td>500.00</td>
                      <td>500.00</td>
                    </tr>
                    <tr>
                      <th>mean</th>
                      <td>33.05</td>
                      <td>12.05</td>
                      <td>37.06</td>
                      <td>3.53</td>
                      <td>499.31</td>
                    </tr>
                    <tr>
                      <th>std</th>
                      <td>0.99</td>
                      <td>0.99</td>
                      <td>1.01</td>
                      <td>1.00</td>
                      <td>79.31</td>
                    </tr>
                    <tr>
                      <th>min</th>
                      <td>29.53</td>
                      <td>8.51</td>
                      <td>33.91</td>
                      <td>0.27</td>
                      <td>256.67</td>
                    </tr>
                    <tr>
                      <th>25%</th>
                      <td>32.34</td>
                      <td>11.39</td>
                      <td>36.35</td>
                      <td>2.93</td>
                      <td>445.04</td>
                    </tr>
                    <tr>
                      <th>50%</th>
                      <td>33.08</td>
                      <td>11.98</td>
                      <td>37.07</td>
                      <td>3.53</td>
                      <td>498.89</td>
                    </tr>
                    <tr>
                      <th>75%</th>
                      <td>33.71</td>
                      <td>12.75</td>
                      <td>37.72</td>
                      <td>4.13</td>
                      <td>549.31</td>
                    </tr>
                    <tr>
                      <th>max</th>
                      <td>36.14</td>
                      <td>15.13</td>
                      <td>40.01</td>
                      <td>6.92</td>
                      <td>765.52</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Análisis gráfico de distribución y correlación
        </h3>
        <ul>
          <li>En la diagonal se pueden observar la distribución de los datos a través de los gráficos de histogramas
          </li>
          <li>En los diagramas de dispersión se pueden observar la correlación entre las distintas distribución de los
            datos para cada par de variables.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">);</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/evaluacion_de_regresion_lineal/image_0001.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Se puede observar claramente la correlación que existe entre las variables, tiempo de membresía de un
            cliente (Lenght of Membership) y la cantidad de dinero gastado por dicho cliente en los servicios de la
            Empresa en un año (Yearly Amount Spent).</li>
        </ul>
        <h3>
          Validación gráfica de la colinealidad
        </h3>
        <ul>
          <li>Se puede observar visualmente la colinealidad entre las dos variables, a través de un segmento de recta
            que representa el modelo de regresión lineal.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Length of Membership&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Yearly Amount Spent&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span><span class="n">df</span><span class="p">);</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/evaluacion_de_regresion_lineal/image_0002.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Preparación del conjunto de datos
        </h3>
        <ul>
          <li>La variable objetivo a predecir es la cantidad de dinero que gasta un cliente en los servicio de la
            Empresa en un año (Yearly Amount Spent).</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Avg. Session Length&#39;</span><span class="p">,</span><span class="s1">&#39;Time on App&#39;</span><span class="p">,</span><span class="s1">&#39;Time on Website&#39;</span><span class="p">,</span><span class="s1">&#39;Length of Membership&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Yearly Amount Spent&#39;</span><span class="p">]</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Separación de subconjuntos de datos, Entrenamiento y Pruebas
        </h3>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Creación del Modelo de Regresión Lineal
        </h3>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[11]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[11]:</div>
            <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
              <pre>LinearRegression()</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Cálculo de los Coeficientes de Regresión
        </h3>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">coeff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lm</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Coefficient&#39;</span><span class="p">])</span>
<span class="nb">round</span><span class="p">(</span><span class="n">coeff_df</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[12]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>Coefficient</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>Avg. Session Length</th>
                      <td>25.55</td>
                    </tr>
                    <tr>
                      <th>Time on App</th>
                      <td>38.49</td>
                    </tr>
                    <tr>
                      <th>Time on Website</th>
                      <td>0.48</td>
                    </tr>
                    <tr>
                      <th>Length of Membership</th>
                      <td>61.78</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Predicciones del Modelo de Regresión Lineal
        </h3>
        <ul>
          <li>A continuación se muestran a través de un gráfico de dispersión los datos predichos por el modelo</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[13]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">predictions</span><span class="p">);</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/evaluacion_de_regresion_lineal/image_0003.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>A continuación los 5 primeros valores de la predicción del modelo.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">predictions</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[15]:</div>
            <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
              <pre>array([557.10944853, 584.96471247, 573.30809474, 551.60732653,
       427.58323562])</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>A continuación los 5 primeros valores del conjunto de datos de pruebas</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[14]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">y_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>
            <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
              <pre>294    557.634109
383    583.977802
435    571.216005
302    541.972204
444    423.470533
Name: Yearly Amount Spent, dtype: float64</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h2>
          ¿Cómo se puede evaluar la efectividad de los modelos de regresión lineal?.
        </h2>
        <h3>
          Error Absoluto Medio (Mean Absolute Error, MAE).
        </h3>
        <p>Es la diferencia absoluta promedio entre los resultados observados y pronosticados.</p>
        <ul>
          <li>error = actual − predicted</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MAE:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>MAE: 7.44
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>
          Conclusión.
        </h3>
        <ul>
          <li>El modelo de regresión lineal tiene un error absoluto medio de 7.44USD, es decir, que en sus predicciones
            absolutas se equivoca en promedio casi siete dólares y medio en el monto que gastará un cliente en los
            servicios de la Empresa en un año.</li>
        </ul>
      </div>
    </div>
</body>

</html>