<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Regresion Lineal Scikit-Learn</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
  <link rel="stylesheet" href="python_css/python_posts.css" />
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe"> </script>
  <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: { 
                    automatic: true 
                    }
                },
                "HTML-CSS": {
                    linebreaks: { 
                    automatic: true 
                    }
                }
            });
        
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
  <!-- ************************ Common Code ************************ -->
  <link href="../../assets/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>
  <link href="../assets/css/headers.css" rel="stylesheet">
  <!-- ************************ Common Code ************************ -->
</head>

<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
  <!-- ************************ Common Code ************************ -->
  <div class="container">
    <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
      <a href="../../index.html" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
        <svg class="bi me-2" width="40" height="32">
          <use xlink:href="#bootstrap" />
        </svg>
        <span style="color: var(--jp-content-link-color);">Volver al Inicio</span>
      </a>
<ul class=" nav nav-pills">
          <li class="nav-item"><a href="visualizaciones_con_pandas.html" class="nav-link">Anterior</a></li>
          <li class="nav-item"><a href="aprendizaje_automatico.html" class="nav-link">Siguiente</a></li>
          </ul>
    </header>
  </div>
  <div style="padding-left: 50px; padding-right: 100px;">
    <!-- ************************ Common Code ************************ -->
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h2>Regresión Lineal con Scikit-learn.
        </h2>
        <p style="font-size: medium;"><strong>Publicado el: 04 de Enero del 2021</strong> - Jhonatan Montilla</p>
        <p>Una de las maneras de predicción más antigua y básica es la regresión lineal, aún hoy día se utiliza
          ampliamente en muchos campos diferentes para extrapolar e interpolar datos. En este artículo, explicaremos los
          conceptos básicos de cómo y cuándo utilizarla con la ayuda de Scikit-learn de Python.</p>
        <p><strong>Carga de librerías</strong></p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">f_regression</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Comenzaremos con un conjunto de datos sencillo para probar un modelo de regresión lineal simple.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">X</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">]]</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Realizamos un gráfico de dispersión de los datos.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/regresion_lineal/Imagen_0001.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>
            <p>Lo datos del conjunto de datos son simétricos, x = y, por lo que será bastante sencillo para nuestro
              modelo de regresión predecir que el valor de la variable dependiente y para x (10) es 10.</p>
          </li>
          <li>
            <p>Creamos el modelo de regrsión lineal a continuación.</p>
          </li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
            <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
              <pre>LinearRegression(fit_intercept=False)</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>En el código anterior primero se define el modelo de regresión lineal con la función
            linear_model.LinearRegression(), luego se ajusta el modelo con la función model.fit (x, y), ahora se
            procederá a revisar el coeficiente del modelo de regresión lineal.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>
            <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
              <pre>array([1.])</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>
            <p>El resultado es: 1. Significa que la ecuación del modelo de regresión lineal es: X = 1 * Y</p>
          </li>
          <li>
            <p>Procederemos a realizar algunas predicciones con nuestro modelo de regresión lineal.</p>
          </li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">X_pred</span><span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">],[</span><span class="mi">11</span><span class="p">],[</span><span class="mi">12</span><span class="p">],[</span><span class="mi">13</span><span class="p">],[</span><span class="mi">14</span><span class="p">]]</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_pred</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>
            <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
              <pre>array([10., 11., 12., 13., 14.])</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Como era de esperar los resultados son lineales y proporcianeles a los valores de la variable
            independiente, esto se debe a que el coeficiente de la ecuación es 1</li>
          <li>Realizamos una gráfica de dispersión</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_pred</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/regresion_lineal/Imagen_0002.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>
            <p>Un resultado completamente esperado una secuencia de puntos que describen una trayectoria con ángulo de
              45°</p>
          </li>
          <li>
            <p>Ahora, se procederá a realizar un modelo de regresión lineal de dos dimensiones.</p>
          </li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="c1"># 1. Conjunto de datos</span>
<span class="n">X</span><span class="o">=</span><span class="p">[[</span><span class="mi">11</span><span class="p">],[</span><span class="mi">12</span><span class="p">],[</span><span class="mi">13</span><span class="p">],[</span><span class="mi">14</span><span class="p">],[</span><span class="mi">15</span><span class="p">],[</span><span class="mi">16</span><span class="p">],[</span><span class="mi">17</span><span class="p">],[</span><span class="mi">18</span><span class="p">],[</span><span class="mi">19</span><span class="p">]]</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="c1"># 2. Definir y ajustar el modelo</span>
<span class="n">model</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coeficiente: &quot;</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># 3. Obtener predicciones</span>
<span class="n">X_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_pred</span><span class="p">)</span>
<span class="c1"># 4. Visualización (valores del conjunto de datos vs predicciones)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>Coeficiente:  [0.35251799] 
</pre>
            </div>
          </div>
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/regresion_lineal/Imagen_0003.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>
            <p>Parece que el modelo de regresión lineal anterior no está funcionando adecuadamente, esto se debe a que
              falta una parte crucial de la ecuación del modelo de regresión lineal. ¡La intercepción!</p>
          </li>
          <li>
            <p>La intersección es un valor constante que se suma a la ecuación independientemente de los valores de las
              variables, para esto será necesario eliminar "fit_intercept = False" y se prueba nuevamente.</p>
          </li>
        </ul>
        <p>Y = intersección + coeficiente <em> X
            Y = (-10) + (1 </em> X)</p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="c1"># Se define y se ajusta el modelo</span>
<span class="n">model</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Intersección: &quot;</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Coeficiente: &quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Obtener predicicones</span>
<span class="n">X_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_pred</span><span class="p">)</span>
<span class="c1"># Visualización</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>
Intersección:  -10.000000000000004
Coeficiente:  [1.] 
</pre>
            </div>
          </div>
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/regresion_lineal/Imagen_0004.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Funciona correctamente, de esta manera se ejecuta una regresión lineal básica.</li>
        </ul>
        <h3>Análisis del modelo de regresión lineal.<a class="anchor-link"
            href="#An%C3%A1lisis-del-modelo-de-regresi%C3%B3n-lineal.">&#182;</a></h3>
        <p>El tipo de regresión utilizada anteriormente es la de los Mínimos Cuadrados Ordinarios (MCO). La manera en
          que este modelo evalúa los resultados a menudo se conoce como métricas, buscando la suma residual de
          cuadrados. El residual es simplemente la diferencia entre el valor predicho por el modelo y el valor real.</p>
        <ul>
          <li>Veamos otro ejemplo.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="c1"># Conjunto de datos</span>
<span class="n">X</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">]]</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="c1"># Crea y ajusta el modelo de regresión lineal</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># Predicciones del modelo</span>
<span class="n">X_pred</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">],[</span><span class="mi">11</span><span class="p">],[</span><span class="mi">12</span><span class="p">],[</span><span class="mi">13</span><span class="p">],[</span><span class="mi">14</span><span class="p">]]</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">X_pred</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_pred</span><span class="p">)</span>
<span class="c1"># Cálculo del Error Cuadrático Medio (MSE)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="c1"># Coeficioente de determinación: 1 será una predicción perfecta</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coeficiente: </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>Error: 0.00
Coeficiente: 1.00
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>
            <p>No existen residuos en esta regresión, por lo tanto el error cuadrático medio es cero.</p>
          </li>
          <li>
            <p><strong>R2</strong> es el coeficiente de determinación, donde una puntuación perfecta sería 1,
              disminuyendo a medida que los puntos predichos se alejan de los valores reales.</p>
          </li>
          <li>
            <p>A continuación se evaluarán varios coeficientes de determinación con diferentes predicciones.</p>
          </li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[11]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="c1"># Predicciones 1</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coeficiente de determinación: </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="c1"># Predicciones 2</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coeficiente de determinación: </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="c1"># Predicciones 3</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coeficiente de determinación: </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>Coeficiente de determinación: 1.00
Coeficiente de determinación: 0.98
Coeficiente de determinación: -3.00
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>
            <p>Hasta los momentos hemos visto cómo construir un modelo de regresión lineal simple, cómo ajustar los
              datos a este, extrapolar conclusiones y las métricas a usar para comparar los modelos.</p>
          </li>
          <li>
            <p>Ahora, veremos algo de bastante importancia. ¡Los supuestos!. Las suposiciones son como requisitos
              previos; tenemos que comprobar para saber si este método funcionará en nuestros datos. no incluir los
              supuestos o ejecutar un modelo de regresión lineal independientemente de estos puede afectarlo de manera
              negativa, reduciendo su presición, es recomedable realizar más investigaciones sobre las suposiciones si
              se va a confiar mucho en los resultados a obtener del modelo, tal como se recomienda para cualquier modelo
              estadístico.</p>
          </li>
          <li>
            <p><strong>Linealidad:</strong> esto significa que la relación entre las dos variables debe ser lineal.</p>
          </li>
          <li>
            <p><strong>Independencia:</strong> las observaciones deben ser independientes entre sí. La cantidad de
              lluvia diaria no depende de cuánto llovió el día siguiente o el anterior, pero la cantidad de agua en un
              depósito depende en gran medida de sus valores anteriores.</p>
          </li>
          <li>
            <p><strong>Homoscedasticidad:</strong> esto significa que los residuos deben tener una varianza constante.
              Las series de tiempo suelen tener problemas con esto. Inicialmente, se obtienen predicciones consistentes,
              sin embargo, el error aumenta a medida que avanza en el tiempo.</p>
          </li>
          <li>
            <p><strong>Normalidad:</strong> los errores deben distribuirse normalmente. En este caso, se deben buscar
              desviaciones significativas de una distribución normal, como una distribución de error muy sesgada hacia
              la derecha o hacia la izquierda.</p>
          </li>
          <li>
            <p><strong>Tamaño de la muestra:</strong> la muestra debe tener al menos 20 observaciones.</p>
          </li>
        </ul>
        <p>Ahora se utilizaremos un modelo MCO con múltiples variables explicativas. Es importante recordar que las
          variables explicativas deben ser independientes entre sí.</p>
        <p>Se creará un conjunto de datos con algunos datos aleatorios y ficticios para una tienda de batidos.</p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="c1"># Crea el conjunto de datos</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># Se cargan los datos ficticios aleatórios</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">250</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;temperatura&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">38</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;prob_lluvia&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;precio_accion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">39.8</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">41.8</span><span class="p">,</span> <span class="mf">46.8</span><span class="p">,</span> <span class="mf">39.11</span><span class="p">,</span> <span class="mf">37.86</span><span class="p">,</span> <span class="mf">35.7</span><span class="p">,</span> <span class="mf">35.9</span><span class="p">,</span> <span class="mf">39.1</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
<span class="c1"># Visualiza el conjunto de datos</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[12]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>0</th>
                      <th>ventas</th>
                      <th>temperatura</th>
                      <th>prob_lluvia</th>
                      <th>precio_accion</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>0</td>
                      <td>100</td>
                      <td>20</td>
                      <td>0.85</td>
                      <td>39.80</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>1</td>
                      <td>120</td>
                      <td>22</td>
                      <td>0.60</td>
                      <td>39.80</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>2</td>
                      <td>115</td>
                      <td>21</td>
                      <td>0.80</td>
                      <td>41.80</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>3</td>
                      <td>150</td>
                      <td>26</td>
                      <td>0.60</td>
                      <td>46.80</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>4</td>
                      <td>175</td>
                      <td>28</td>
                      <td>0.55</td>
                      <td>39.11</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[14]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="c1"># Gráficos de dispersión de las variables, temperatura,</span>
<span class="c1"># probabilidad de lluvia, y precio de la acción según</span>
<span class="c1"># las ventas</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;temperatura&#39;</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;prob_lluvia&#39;</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;precio_accion&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/regresion_lineal/Imagen_0005.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <p>Con las tres variables se pretende predecir las ventas de batidos, a través de la temperatura, la
          probabilidad de que llueva ese día y el valor de cierre diario del precio de las acciones de Microsoft.
          Quizás, la última no es la mejor opción para ayudarnos a predecir las ventas de batidos. Existen varias
          maneras de comprobar si una variable ayuda a predecir el resultado de otra. Este método se denomina
          <strong>Selección de Características.</strong></p>
        <p>El método más utilizado es verificar el valor p, el valor p indica la probabilidad de encontrar valores tan
          extremos como los observados en los valores de pruebas. por lo tanto, los coeficientes son una medida de la
          relación entre dos variables, y el valor p de los coeficientes es una medida de la significancia estadística.
        </p>
        <p>Se entenderá mejor este concepto a través del siguiente ejemplo.</p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">F</span><span class="p">,</span> <span class="n">pval</span> <span class="o">=</span> <span class="n">f_regression</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;precio_accion&#39;</span><span class="p">,</span><span class="s1">&#39;prob_lluvia&#39;</span><span class="p">,</span><span class="s1">&#39;temperatura&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;precio_accion: </span><span class="si">%.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">prob_lluvia: </span><span class="si">%.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">temperatura: </span><span class="si">%.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pval</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>precio_accion: 0.36620290 
prob_lluvia: 0.00020982 
temperatura: 0.00000000
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <p>Haciendo uso de la clase f_regression() de ScikitLearn, feature_selection. Este método devuelve los valores F
          y los valores p, por ahora, se analizarán los valores p, buscando relaciones con una significancia estadística
          igual o superior al 95%, en otras palabras, un valor p inferior al 5%. Como se puede observar ver en los
          resultados, el precio de las acciones de Microsoft no es una variable útil para predecir las ventas de
          batidos.</p>
        <p>A continuación el ejemplo completo.</p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="c1"># Ajusta el modelo, se obtiene la intercepción y el coeficiente</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;prob_lluvia&#39;</span><span class="p">,</span> <span class="s1">&#39;temperatura&#39;</span><span class="p">,]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Intercepción: &#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coeficiente: &#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
<span class="c1"># Se muestra la ecuación del modelo de regresión lineal</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Ventas = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="s1">&#39;+ (</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;* Probabilidad de Lluvia) + (</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39; * Temperatura)&#39;</span><span class="p">)</span>
<span class="c1"># Obtiene predicciones</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;prob_lluvia&#39;</span><span class="p">,</span><span class="s1">&#39;temperatura&#39;</span><span class="p">]])</span>
<span class="c1"># Calcula el Error Cuadrático Medio (MSE)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Error (MSE): </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">],</span><span class="n">y_pred</span><span class="p">))</span>
<span class="c1"># Calcula el Coeficiente de Determinación</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coeficiente de Determinación: </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">],</span><span class="n">y_pred</span><span class="p">))</span>
<span class="c1"># Representación gráfica del modelo de regresión lineal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ventas&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Predicicones&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventas reales&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>Intercepción:  0.0
Coeficiente:  [-43.55818331   6.91493153]

Ventas = 0.00 + (-43.56 * Probabilidad de Lluvia) + (6.91  * Temperatura)

Error (MSE): 26.99
Coeficiente de Determinación: 0.99
</pre>
            </div>
          </div>
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedImage jp-OutputArea-output ">
              <img src="python_images/regresion_lineal/Imagen_0006.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[17]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicción: </span><span class="si">%.0f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">27</span><span class="p">]]))</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>Predicción: 182
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Si mañana el pronóstico del clima indica una temperatura de 27°C con un 10% de probabilidad de lluvia,
            según el modelo de regresión lineal se estima vender alrededor de 182 batidos.</li>
        </ul>
        <p>Ventas = 0.00 + (-43.56 x 0.1) + (6.91 x 27)</p>
        <p>Ventas = -4.37 + 186.57</p>
        <p>Ventas = ~182</p>
        <ul>
          <li>
            <p>Existen diferentes métodos de selección de funciones, métricas, y suposiciones que permiten verificar los
              datos, métodos de validación cruzada y mucho más.</p>
          </li>
          <li>
            <p>Esperamos que este resumen sobre regresión lineal le haya ayudado a entender los conceptos básicos para
              desarrollar más conocimientos sobre este interesante tema.</p>
          </li>
        </ul>
      </div>
    </div>
</body>

</html>