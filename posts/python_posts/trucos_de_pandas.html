<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Más trucos de Pandas</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
  <link rel="stylesheet" href="python_css/python_posts.css" />
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe"> </script>
  <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: { 
                    automatic: true 
                    }
                },
                "HTML-CSS": {
                    linebreaks: { 
                    automatic: true 
                    }
                }
            });
        
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
  <!-- ************************ Common Code ************************ -->
  <link href="../../assets/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>
  <link href="../assets/css/headers.css" rel="stylesheet">
  <!-- ************************ Common Code ************************ -->
</head>

<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
  <!-- ************************ Common Code ************************ -->
  <div class="container">
    <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
      <a href="../../index.html" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
        <svg class="bi me-2" width="40" height="32">
          <use xlink:href="#bootstrap" />
        </svg>
        <span style="color: var(--jp-content-link-color);">Volver al Inicio</span>
      </a>
<ul class=" nav nav-pills">
          <li class="nav-item"><a href="pandas_tips.html" class="nav-link">Anterior</a></li>
          <li class="nav-item"><a href="visualizaciones_con_pandas.html" class="nav-link">Siguiente</a></li>
          </ul>
    </header>
  </div>
  <div style="padding-left: 50px; padding-right: 100px;">
    <!-- ************************ Common Code ************************ -->
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h2>Más trucos de Pandas.</h2>
        <p style="font-size: medium;"><strong>Publicado el: 19 de Diciembre del 2020</strong> - Jhonatan Montilla</p>
        <h3>Función concat() que debes conocer para acelerar tus análisis de datos.</h3>
        <p>Pandas proporciona varias funciones integradas para combinar fácilmente DataFrames. Entre ellos, la función
          concat() parece bastante sencilla de usar, pero todavía hay muchos trucos que debe conocer para acelerar su
          análisis de datos.</p>
        <p>En este artículo, aprenderá a tratar con los siguientes inconvenientes comunes:</p>
        <ol>
          <li>Tratamiento de índices y ejes</li>
          <li>Evitar índices duplicados</li>
          <li>Agregar índice jerárquico con opciones de claves y nombres</li>
          <li>Correspondencia y clasificación de columnas</li>
          <li>Carga y concatenación de conjuntos de datos de un montón de archivos CSV</li>
        </ol>
        <p>Primeramente se procede a la carga de las librerías</p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pathlib2</span> <span class="k">as</span> <span class="nn">pl2</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>1. Tratamiento de índices y ejes<a class="anchor-link"
            href="#1.-Tratamiento-de-%C3%ADndices-y-ejes">&#182;</a></h3>
        <p>Se tienen dos conjuntos de datos sobre las calificaciones de exámenes de un grupo de alumnos.</p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span>
    <span class="s1">&#39;math&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">82</span><span class="p">,</span><span class="mi">70</span><span class="p">],</span>
    <span class="s1">&#39;physics&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">66</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">66</span><span class="p">],</span>
    <span class="s1">&#39;chemistry&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">61</span><span class="p">,</span><span class="mi">91</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">70</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">],</span>
    <span class="s1">&#39;math&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">66</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">66</span><span class="p">],</span>
    <span class="s1">&#39;physics&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">82</span><span class="p">,</span><span class="mi">70</span><span class="p">],</span>
    <span class="s1">&#39;chemistry&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>
<span class="p">})</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>
            <p>La concatenación es bastante simple con la función concat(), consiste en pasar una lista de DataFrames,
              por ejemplo [df1, df2]. Y de manera predeterminada, está concatenando verticalmente a lo largo del eje 0 y
              conservando todos los índices existentes.</p>
          </li>
          <li>
            <p>Si desea que la concatenación ignore los índices existentes, puede establecer el argumento ignore_index =
              True. Luego, el índice DataFrame resultante se etiquetará con 0,…, n-1.</p>
          </li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>name</th>
                      <th>math</th>
                      <th>physics</th>
                      <th>chemistry</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>A</td>
                      <td>60</td>
                      <td>66</td>
                      <td>61</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>B</td>
                      <td>89</td>
                      <td>95</td>
                      <td>91</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>C</td>
                      <td>82</td>
                      <td>83</td>
                      <td>77</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>D</td>
                      <td>70</td>
                      <td>66</td>
                      <td>70</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>E</td>
                      <td>66</td>
                      <td>60</td>
                      <td>90</td>
                    </tr>
                    <tr>
                      <th>5</th>
                      <td>F</td>
                      <td>95</td>
                      <td>89</td>
                      <td>81</td>
                    </tr>
                    <tr>
                      <th>6</th>
                      <td>G</td>
                      <td>83</td>
                      <td>82</td>
                      <td>78</td>
                    </tr>
                    <tr>
                      <th>7</th>
                      <td>H</td>
                      <td>66</td>
                      <td>70</td>
                      <td>90</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Para concatenar DataFrames horizontalmente a lo largo del eje 1, puede establecer el argumento axis = 1.
          </li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>name</th>
                      <th>math</th>
                      <th>physics</th>
                      <th>chemistry</th>
                      <th>name</th>
                      <th>math</th>
                      <th>physics</th>
                      <th>chemistry</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>A</td>
                      <td>60</td>
                      <td>66</td>
                      <td>61</td>
                      <td>E</td>
                      <td>66</td>
                      <td>60</td>
                      <td>90</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>B</td>
                      <td>89</td>
                      <td>95</td>
                      <td>91</td>
                      <td>F</td>
                      <td>95</td>
                      <td>89</td>
                      <td>81</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>C</td>
                      <td>82</td>
                      <td>83</td>
                      <td>77</td>
                      <td>G</td>
                      <td>83</td>
                      <td>82</td>
                      <td>78</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>D</td>
                      <td>70</td>
                      <td>66</td>
                      <td>70</td>
                      <td>H</td>
                      <td>66</td>
                      <td>70</td>
                      <td>90</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>2. Evitar índices duplicados</h3>
        <ul>
          <li>La función concat() conserva los índices, para establecer que los índices en el resultado de pd.concat()
            no se superpongann, se establece el argumento verify_integrity = True. Con este establecido en Verdadero,
            generará una excepción si hay índices duplicados.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">],</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ValueError&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
            <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
              <pre>ValueError Indexes have overlapping values: Int64Index([0, 1, 2, 3], dtype=&#39;int64&#39;)
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>3. Agregar un índice jerárquico con opciones de claves y nombres</h3>
        <p>Es muy útil agregar un índice jerárquico (también conocido como índice multinivel) para un análisis de datos
          más sofisticado. En este caso, se agrega el año 1 y el año 2 del índice para df1 y df2 respectivamente. Para
          hacer esto, simplemente se especifica el argumento en las claves.</p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Year 1&#39;</span><span class="p">,</span><span class="s1">&#39;Year 2&#39;</span><span class="p">])</span>
<span class="n">res</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[7]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th></th>
                      <th>name</th>
                      <th>math</th>
                      <th>physics</th>
                      <th>chemistry</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th rowspan="4" valign="top">Year 1</th>
                      <th>0</th>
                      <td>A</td>
                      <td>60</td>
                      <td>66</td>
                      <td>61</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>B</td>
                      <td>89</td>
                      <td>95</td>
                      <td>91</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>C</td>
                      <td>82</td>
                      <td>83</td>
                      <td>77</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>D</td>
                      <td>70</td>
                      <td>66</td>
                      <td>70</td>
                    </tr>
                    <tr>
                      <th rowspan="4" valign="top">Year 2</th>
                      <th>0</th>
                      <td>E</td>
                      <td>66</td>
                      <td>60</td>
                      <td>90</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>F</td>
                      <td>95</td>
                      <td>89</td>
                      <td>81</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>G</td>
                      <td>83</td>
                      <td>82</td>
                      <td>78</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>H</td>
                      <td>66</td>
                      <td>70</td>
                      <td>90</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Por lo tanto, para acceder a un grupo específico de valores, por ejemplo, Año 1</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Year 1&#39;</span><span class="p">]</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[8]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>name</th>
                      <th>math</th>
                      <th>physics</th>
                      <th>chemistry</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>A</td>
                      <td>60</td>
                      <td>66</td>
                      <td>61</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>B</td>
                      <td>89</td>
                      <td>95</td>
                      <td>91</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>C</td>
                      <td>82</td>
                      <td>83</td>
                      <td>77</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>D</td>
                      <td>70</td>
                      <td>66</td>
                      <td>70</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Además, los nombres de los argumentos se pueden utilizar para agregar nombres al índice jerárquico
            resultante. Por ejemplo: agregue el nombre Class al índice más externo que acabamos de crear.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> 
    <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Year 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Year 2&#39;</span><span class="p">],</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[9]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th></th>
                      <th>name</th>
                      <th>math</th>
                      <th>physics</th>
                      <th>chemistry</th>
                    </tr>
                    <tr>
                      <th>Class</th>
                      <th></th>
                      <th></th>
                      <th></th>
                      <th></th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th rowspan="4" valign="top">Year 1</th>
                      <th>0</th>
                      <td>A</td>
                      <td>60</td>
                      <td>66</td>
                      <td>61</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>B</td>
                      <td>89</td>
                      <td>95</td>
                      <td>91</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>C</td>
                      <td>82</td>
                      <td>83</td>
                      <td>77</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>D</td>
                      <td>70</td>
                      <td>66</td>
                      <td>70</td>
                    </tr>
                    <tr>
                      <th rowspan="4" valign="top">Year 2</th>
                      <th>0</th>
                      <td>E</td>
                      <td>66</td>
                      <td>60</td>
                      <td>90</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>F</td>
                      <td>95</td>
                      <td>89</td>
                      <td>81</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>G</td>
                      <td>83</td>
                      <td>82</td>
                      <td>78</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>H</td>
                      <td>66</td>
                      <td>70</td>
                      <td>90</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>También se puede restablecer un índice y convertirlo en una columna de datos, a través de reset_index()
          </li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> 
    <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Year 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Year 2&#39;</span><span class="p">],</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># reset_index(level=&#39;Class&#39;)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[10]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>Class</th>
                      <th>name</th>
                      <th>math</th>
                      <th>physics</th>
                      <th>chemistry</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>Year 1</td>
                      <td>A</td>
                      <td>60</td>
                      <td>66</td>
                      <td>61</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>Year 1</td>
                      <td>B</td>
                      <td>89</td>
                      <td>95</td>
                      <td>91</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>Year 1</td>
                      <td>C</td>
                      <td>82</td>
                      <td>83</td>
                      <td>77</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>Year 1</td>
                      <td>D</td>
                      <td>70</td>
                      <td>66</td>
                      <td>70</td>
                    </tr>
                    <tr>
                      <th>0</th>
                      <td>Year 2</td>
                      <td>E</td>
                      <td>66</td>
                      <td>60</td>
                      <td>90</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>Year 2</td>
                      <td>F</td>
                      <td>95</td>
                      <td>89</td>
                      <td>81</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>Year 2</td>
                      <td>G</td>
                      <td>83</td>
                      <td>82</td>
                      <td>78</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>Year 2</td>
                      <td>H</td>
                      <td>66</td>
                      <td>70</td>
                      <td>90</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>4. Columnas coincidentes y ordenadas</h3>
        <p>La función concat() puede concatenar DataFrames con las columnas en un orden diferente. De forma
          predeterminada, el DataFrame resultante tendría la misma clasificación que el primer DataFrame. Por ejemplo,
          en el siguiente ejemplo, es el mismo orden que df1.</p>
        <ul>
          <li>Si prefiere que el DataFrame resultante se ordene alfabéticamente, puede establecer el argumento sort =
            True.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[11]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[11]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>chemistry</th>
                      <th>math</th>
                      <th>name</th>
                      <th>physics</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>61</td>
                      <td>60</td>
                      <td>A</td>
                      <td>66</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>91</td>
                      <td>89</td>
                      <td>B</td>
                      <td>95</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>77</td>
                      <td>82</td>
                      <td>C</td>
                      <td>83</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>70</td>
                      <td>70</td>
                      <td>D</td>
                      <td>66</td>
                    </tr>
                    <tr>
                      <th>0</th>
                      <td>90</td>
                      <td>66</td>
                      <td>E</td>
                      <td>60</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>81</td>
                      <td>95</td>
                      <td>F</td>
                      <td>89</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>78</td>
                      <td>83</td>
                      <td>G</td>
                      <td>82</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>90</td>
                      <td>66</td>
                      <td>H</td>
                      <td>70</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Si prefiere una ordenación personalizada, a continuación se explica cómo hacerlo:</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">custom_sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;math&#39;</span><span class="p">,</span> <span class="s1">&#39;chemistry&#39;</span><span class="p">,</span> <span class="s1">&#39;physics&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>
<span class="n">res</span><span class="p">[</span><span class="n">custom_sort</span><span class="p">]</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[12]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>math</th>
                      <th>chemistry</th>
                      <th>physics</th>
                      <th>name</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>60</td>
                      <td>61</td>
                      <td>66</td>
                      <td>A</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>89</td>
                      <td>91</td>
                      <td>95</td>
                      <td>B</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>82</td>
                      <td>77</td>
                      <td>83</td>
                      <td>C</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>70</td>
                      <td>70</td>
                      <td>66</td>
                      <td>D</td>
                    </tr>
                    <tr>
                      <th>0</th>
                      <td>66</td>
                      <td>90</td>
                      <td>60</td>
                      <td>E</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>95</td>
                      <td>81</td>
                      <td>89</td>
                      <td>F</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>83</td>
                      <td>78</td>
                      <td>82</td>
                      <td>G</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>66</td>
                      <td>90</td>
                      <td>70</td>
                      <td>H</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>Se almacenan los conjuntos de datos en archivos .CSV para la ejecución de próximo ejercicio.</li>
        </ul>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;test/df1.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;test/df2.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <h3>5. Carga y concatenación de conjuntos de datos de un montón de archivos CSV</h3>
        <p>Supongamos que necesitamos cargar y concatenar conjuntos de datos desde varios archivos .CSV contenidos en un
          directorio, a través de un bucle for se puede efectuar dicha tarea.</p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
            <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3">
                <pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">pl2</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;test/&#39;</span><span class="p">)</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.csv&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span>
<span class="n">res</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
              data-mime-type="text/html">
              <div>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>name</th>
                      <th>math</th>
                      <th>physics</th>
                      <th>chemistry</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>0</th>
                      <td>A</td>
                      <td>60</td>
                      <td>66</td>
                      <td>61</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>B</td>
                      <td>89</td>
                      <td>95</td>
                      <td>91</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>C</td>
                      <td>82</td>
                      <td>83</td>
                      <td>77</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>D</td>
                      <td>70</td>
                      <td>66</td>
                      <td>70</td>
                    </tr>
                    <tr>
                      <th>0</th>
                      <td>E</td>
                      <td>66</td>
                      <td>60</td>
                      <td>90</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>F</td>
                      <td>95</td>
                      <td>89</td>
                      <td>81</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>G</td>
                      <td>83</td>
                      <td>82</td>
                      <td>78</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>H</td>
                      <td>66</td>
                      <td>70</td>
                      <td>90</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
        <ul>
          <li>
            <p>Una sola línea de código lee todos los archivos .CSV y genera una lista de DataFrames dfs. Luego, solo
              necesitamos llamar a pd.concat (dfs) una vez para obtener el mismo resultado.</p>
          </li>
          <li>
            <p>Si desea calcula el tiempo de ambas ejecuciones, lo puede hacer utilizando %% timeit, probablemente
              encontrará que esta solución ahorra la mitad del tiempo.</p>
          </li>
          <li>
            <p>La concatenación de varios conjuntos de datos ahorra tiempo y códigos. Es una manera sencilla de generar
              una lista en comparación con el uso de bucles.</p>
          </li>
        </ul>
      </div>
    </div>
</body>

</html>